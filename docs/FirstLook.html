<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Logo and EDLogo</title>

<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>




<link rel="stylesheet" href="cosmo.css" type="text/css" />

</head>

<body>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:100,300,400,600" rel="stylesheet" type="text/css">
    <link href="../docs/cosmo.css" rel="stylesheet">
    <link href="../docs/cosmo.min.css" rel="stylesheet">
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="../docs/bootstrap/js/bootstrap.min.js"></script>

<body>

<div class = "nav" align = "middle">
<div class= "p1"></div>
<p>
  <a class="btn btn-large btn btn-primary" type="button" href = "Logolas_home.html">HOME</a>
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "Gallery.html">GALLERY</a>
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "https://github.com/kkdey/Logolas">SOFTWARE</a>
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "workflow.html">VIGNETTES</a>
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "license.html">LICENSE</a>
   &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "https://github.com/kkdey/Logolas-pages">GITHUB</a>
 </p>
</div>
<!-- <div class="nav">
  <a href="index.html">Home page</a> &nbsp &nbsp
  <a href="musings.html">Musings</a> &nbsp &nbsp
  <a href="town.html">My town</a> &nbsp &nbsp
  <a href="links.html">Links</a>
</div> -->

<!-- Main content -->
</body>
</html>


<h1 class="title toc-ignore">Logo and EDLogo</h1>


<div id="TOC">
<ul>
<li><a href="#standard-logo">Standard Logo</a><ul>
<li><a href="#simple-illustration">Simple Illustration</a></li>
<li><a href="#information-criterion-and-background-probabilities">Information Criterion and Background Probabilities</a></li>
<li><a href="#color-palettes-in-logolas">Color palettes in Logolas</a></li>
<li><a href="#other-entropy-measures">Other entropy measures</a></li>
</ul></li>
<li><a href="#edlogo-plot">EDLogo Plot</a><ul>
<li><a href="#intuition">Intuition</a></li>
<li><a href="#algorithm-for-nlogomaker-height-detection">Algorithm for nlogomaker height detection</a></li>
<li><a href="#scaling-and-scoring-schemes">Scaling and Scoring schemes</a></li>
<li><a href="#border-and-fill">Border and fill</a></li>
</ul></li>
<li><a href="#session-information">Session information</a></li>
</ul>
</div>

<!-- The file analysis/chunks.R contains chunks that define default settings
shared across the workflowr files. -->
<!-- Update knitr chunk options -->
<!-- Insert the date the file was last updated -->
<p><strong>Last updated:</strong> 2017-11-14</p>
<!-- Insert the code version (Git commit SHA1) if Git repository exists and R
 package git2r is installed -->
<p><strong>Code version:</strong> a9d8ae3</p>
<!-- Add your analysis here -->
<div id="standard-logo" class="section level2">
<h2>Standard Logo</h2>
<div id="simple-illustration" class="section level3">
<h3>Simple Illustration</h3>
<p>One of the primary applications of logo plots is in visualizing DNA sequence motif (e.g.: <a href="http://bioconductor.org/packages/release/bioc/html/seqLogo.html">seqLogo</a>). These logo plots comorise of 4 characters (A,C,G and T) corresponding to the 4 bases. We start with an example application from <a href="https://bioconductor.org/packages/release/bioc/html/seqLogo.html">seqLogo</a></p>
<pre class="r"><code>library(grid)
library(gridBase)
mFile &lt;- system.file(&quot;Exfiles/pwm1&quot;, package=&quot;seqLogo&quot;)
m &lt;- read.table(mFile)
p &lt;- seqLogo::makePWM(m)
seqLogo::seqLogo(p)</code></pre>
<p><img src="figure/FirstLook.Rmd/unnamed-chunk-1-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We illustrate how a standard logo plot can be created in <strong>Logolas</strong> using the . <code>logomaker()</code> function.</p>
<pre class="r"><code>library(Logolas)
color_profile &lt;- list(&quot;type&quot; = &quot;per_row&quot;,
&quot;col&quot; = RColorBrewer::brewer.pal(dim(p@pwm)[1],name =&quot;Spectral&quot;))
logomaker(p@pwm,color_profile = color_profile, ic.scale = TRUE)</code></pre>
<p><img src="figure/FirstLook.Rmd/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>As evident from the above example, <code>logomaker</code> offers the user several options to stylize the plot.</p>
<ul>
<li><p><strong>color_profile</strong> : This option allows the user to specify the color palettes for different symbols. This is a list argument with two items - a <code>type</code> variable and a <code>color</code> variable. The <code>type</code> variable represents the coloring scheme and can be either of three choices - <code>per_row</code>, <code>per_symbol</code> and <code>per_column</code> depending on whether the user wants to fix a color for a specific row name of the PWM matrix, or for each column or for a specific character of an alphanumeric string. We shall discuss these different choices in greater detail in the next section.</p></li>
<li><p><strong>ic.scale</strong> : If TRUE (which is also the default), Information Content (I.C) is used to determine the stack heights in the logo plot. If FALSE, the stack heights are scaled to 1.</p></li>
</ul>
</div>
<div id="information-criterion-and-background-probabilities" class="section level3">
<h3>Information Criterion and Background Probabilities</h3>
<p>As default, <code>logomaker</code> assumes that the background probability of the occurrence of each base at a position is discrete uniform. However, when a background probability is known for a specific position of the sequence, the user may use that information to relatively scale the heights.</p>
<p>The information content for position <span class="math inline">\(i\)</span> is then calculated as follows</p>
<p><span class="math display">\[IC_i=\Sigma_b p_{b, i}\times \log_2p_{b, i}-(\Sigma_b p_{b,i}\times \log_2q_{b,i})\]</span></p>
<p>where <span class="math inline">\(p_{b,i}\)</span> is the relative frequency of base <span class="math inline">\(b\)</span> at position <span class="math inline">\(i\)</span> and <span class="math inline">\(q_{b, i}\)</span> is the background probability of base <span class="math inline">\(b\)</span> and position <span class="math inline">\(i\)</span>.</p>
<p>The background probability can be fixed through the input <code>bg</code> in <code>logomaker</code>. <code>bg</code> can be a matrix, vector or NULL. When <code>bg</code> is a matrix, each position has a specific base probability <span class="math inline">\(q_{b,i}\)</span>, if <code>bg</code> is a vector, it is assumed that <span class="math inline">\(q_{b,i} = q_{b}\)</span> for all <span class="math inline">\(i\)</span>, and if NULL, the background probability is assumed to be same for all the bases ( for example - <span class="math inline">\(q_{b,i} = 0.25\)</span> for DNA/RNA sequence data with no specified <code>bg</code>).</p>
<p>We present examples of Logolas with different options for <code>bg</code>. We plot here a multi-panel Logolas plot for different choices of <code>bg</code>.</p>
<p>[A FIGURE GOES HERE]</p>
<pre class="r"><code>logomaker(p@pwm,xlab = &#39;position&#39;,color_profile = color_profile,
          frame_width = 1,
          bg=c(0.32, 0.18, 0.2, 0.3),
          pop_name = &#39;Change background prob&#39;,
          control = list(viewport.margin.left = 5))</code></pre>
<p><img src="figure/FirstLook.Rmd/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="color-palettes-in-logolas" class="section level3">
<h3>Color palettes in Logolas</h3>
<p>Logolas also allows the user to choose different color palettes</p>
<pre class="r"><code>color_profile1=list(&quot;type&quot; = &quot;per_row&quot;,
&quot;col&quot; = RColorBrewer::brewer.pal(dim(p@pwm)[1],name =&quot;PiYG&quot;))
logomaker(p@pwm,xlab = &#39;position&#39;,color_profile = color_profile1,
          frame_width = 1,
          pop_name = &#39;Change color&#39;,
          control = list(viewport.margin.left = 5))</code></pre>
<pre><code>using a background with equal probability for all symbols</code></pre>
<p><img src="figure/FirstLook.Rmd/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="other-entropy-measures" class="section level3">
<h3>Other entropy measures</h3>
<p>Besides the default Shannon entropy, <code>logomaker</code> can also determine the Information content using Renyi entropy. For this entropy measure, the Information content at position <span class="math inline">\(i\)</span> is <span class="math inline">\(IC_{i,\alpha}=\frac{1}{1-\alpha}\Sigma_b\log_2(q_{b,i}^\alpha-0.25^{1-\alpha})\)</span>. When <span class="math inline">\(\alpha\rightarrow1\)</span>, the limiting value of Renyi entropy is the Shannon entropy. In <code>logomaker</code>, <code>alpha</code> is a control parameter that can be tuned to get plots for different entropy measures. The figure below shows the logo plots with different values of <span class="math inline">\(\alpha\)</span>.</p>
<pre class="r"><code>get_viewport_logo(1, 2)
seekViewport(paste0(&quot;plotlogo&quot;, 1))
logomaker(p@pwm,xlab = &#39;position&#39;,color_profile = color_profile,
          frame_width = 1,
          newpage = FALSE,
          pop_name = &#39;Logo plot, Alpha=2&#39;,
          control = list(viewport.margin.left = 5,alpha=2))


seekViewport(paste0(&quot;plotlogo&quot;, 2))
logomaker(p@pwm,xlab = &#39;position&#39;,color_profile = color_profile,
          frame_width = 1,
          newpage = FALSE,
          pop_name = &#39;Logo plot, Alpha=0.2&#39;,
          control = list(viewport.margin.left = 5,alpha=0.2))</code></pre>
<p><img src="figure/FirstLook.Rmd/unnamed-chunk-5-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="edlogo-plot" class="section level2">
<h2>EDLogo Plot</h2>
<div id="intuition" class="section level3">
<h3>Intuition</h3>
<p>Standard logo plots primarily highlight enrichment of characters at a position. We introduce an alternative logo plot called  that highlights both enrichment and depletion, thereby leading to a more visually parsimonious representation. For examples, suppose for a particular position <span class="math inline">\(i\)</span>, the base composition of $ (A, C, G, T )$ is as follows</p>
<p><span class="math display">\[ \left (A, C, G, T \right ) : = \left ( 0.33, 0.33, 0.01, 0.33 \right )  \]</span></p>
<p>Then the logo plot above would highlight <span class="math inline">\(A, C, T\)</span> for that position. Also, the information content would be lower compared to an enrichment of a single symbol. But, a more ideal representation would be to show the depletion of <span class="math inline">\(G\)</span> instead since that is the base that has changed the most from normal.</p>
<p>We use <code>nlogomaker</code> function in Logolas to plot the <em>EDLogo</em>. Various scoring schemes and scaling options are available for the <em>EDLogo</em>, which we demonstrate in our algorithm below.</p>
</div>
<div id="algorithm-for-nlogomaker-height-detection" class="section level3">
<h3>Algorithm for nlogomaker height detection</h3>
<p>Following are the steps to determine the heights of the logos for <code>log</code> based approach.</p>
<p>For each position of the sequence, $ p = ((p_{b}))$ be the vector of relative frequencies of the bases at that position and <span class="math inline">\(q = ((q_{b}))\)</span> be the corresponding background.</p>
<ol style="list-style-type: decimal">
<li>For the default option (<code>log</code> approach), compute a score <span class="math inline">\(r_{b}\)</span></li>
</ol>
<p><span class="math display">\[ r_b=\log_2\frac{p_b+\epsilon}{q_b+\epsilon}-median \left (\log_2\frac{p_b + \epsilon}{q_b + \epsilon} : b = 1(|) B \right) \]</span></p>
<ol start="3" style="list-style-type: decimal">
<li><p>Determine $ r^{+}<em>{b} = max (r_b, 0) $ and $ r^{-}</em>{b} = max(-r_b, 0) $.</p></li>
<li><p>For the <code>ic</code> scaling approach, we also calculate the IC measure for that position (based on Shannon entropy or Renyi entropy)</p></li>
</ol>
<p>6.Caluclate $ r^{+}<em>{b} IC *  $ and $ r^{-}</em>{b} IC *  $.</p>
<ol start="4" style="list-style-type: decimal">
<li>$ r^{+}<em>{b} $ scores are plotted along the positive Y axis and $ r^{-}</em>{b} $ scores are plotted along the negative Y axis.</li>
</ol>
</div>
<div id="scaling-and-scoring-schemes" class="section level3">
<h3>Scaling and Scoring schemes</h3>
<p>Besides the <code>log</code> (unscaled) and <code>ic-log</code> (scaled) versions discussed here, <strong>Logolas</strong> offers other measures that replace the log ratio in Step 2 by ratio, or log-odds ratio or by probability weighted KL ratio. See the options for <code>logoheight</code> in <code>nlogomaker</code>.</p>
<pre class="r"><code>get_viewport_logo(2, 2, heights_1 = 20)
seekViewport(paste0(&quot;plotlogo&quot;, 1))
nlogomaker(p@pwm,logoheight = &#39;log&#39;,color_profile = color_profile,frame_width = 1,newpage = FALSE)


seekViewport(paste0(&quot;plotlogo&quot;, 2))
nlogomaker(p@pwm,logoheight = &#39;ic_log&#39;,color_profile = color_profile,frame_width = 1,newpage = FALSE)

seekViewport(paste0(&quot;plotlogo&quot;, 3))
nlogomaker(p@pwm,logoheight = &#39;ratio&#39;,color_profile = color_profile,frame_width = 1,newpage = FALSE)

seekViewport(paste0(&quot;plotlogo&quot;, 4))
nlogomaker(p@pwm,logoheight = &#39;ic_ratio&#39;,color_profile = color_profile,frame_width = 1,newpage = FALSE)</code></pre>
<p><img src="figure/FirstLook.Rmd/unnamed-chunk-6-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>All the versions of the  capture the strong depletion of T at the position 4, which is downplayed by the standard logo. At the same time, like the standrad logo, the enrichments are also clearly highlighted by the  plot. The depletion signal is clearer in the unscaled versions and the scaled versions still seem slightly biased towards enrichments</p>
</div>
<div id="border-and-fill" class="section level3">
<h3>Border and fill</h3>
<p>Logolas allows the user to customize the border and fill of the logos and also have separate border and fill rules for the enrichment and depletion of logos. The figure below shows the various options of choosing border and fill for making the logos.</p>
<pre class="r"><code>get_viewport_logo(2, 2, heights_1 = 20)

seekViewport(paste0(&quot;plotlogo&quot;, 1))
nlogomaker(p@pwm,xlab = &#39;position&#39;,logoheight = &quot;log&quot;,
color_profile = color_profile,control = list(tofill_pos = TRUE, tofill_neg=FALSE), newpage = FALSE)

seekViewport(paste0(&quot;plotlogo&quot;, 2))
nlogomaker(p@pwm,xlab = &#39;position&#39;,logoheight = &quot;log&quot;,
color_profile = color_profile, control = list(tofill_pos = FALSE, tofill_neg=TRUE), newpage = FALSE)

seekViewport(paste0(&quot;plotlogo&quot;, 3))
nlogomaker(p@pwm,xlab = &#39;position&#39;,logoheight = &quot;log&quot;, color_profile = color_profile,control = list(tofill_pos = TRUE, tofill_neg=TRUE),
newpage = FALSE)

seekViewport(paste0(&quot;plotlogo&quot;, 4))
nlogomaker(p@pwm,xlab = &#39;position&#39;,logoheight = &quot;log&quot;, color_profile = color_profile, control = list(tofill_pos = FALSE, tofill_neg=FALSE),
newpage = FALSE)</code></pre>
<p><img src="figure/FirstLook.Rmd/unnamed-chunk-7-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="session-information" class="section level2">
<h2>Session information</h2>
<!-- Insert the session information into the document -->
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.4.2 (2017-09-28)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS Sierra 10.12.5

Matrix products: default
BLAS: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
[1] Logolas_1.2.1  gridBase_0.4-7

loaded via a namespace (and not attached):
 [1] Rcpp_0.12.13       knitr_1.16         magrittr_1.5      
 [4] munsell_0.4.3      SQUAREM_2017.10-1  colorspace_1.3-2  
 [7] rlang_0.1.4        stringr_1.2.0      plyr_1.8.4        
[10] tools_3.4.2        gtable_0.2.0       seqLogo_1.44.0    
[13] git2r_0.19.0       htmltools_0.3.6    yaml_2.1.14       
[16] lazyeval_0.2.0     rprojroot_1.2      digest_0.6.12     
[19] tibble_1.3.4       RColorBrewer_1.1-2 ggplot2_2.2.1     
[22] evaluate_0.10.1    rmarkdown_1.6      stringi_1.1.5     
[25] compiler_3.4.2     scales_0.4.1       backports_1.1.0   
[28] stats4_3.4.2      </code></pre>
</div>

<hr>
<p>
    This webpage has been developed using RStudio's <a href="http://rmarkdown.rstudio.com">R Markdown</a> and John D Blischak's <a href="https://github.com/jdblischak/workflowr">workflowr</a> package. 
</p>
<hr>

<!-- To enable disqus, uncomment the section below and provide your disqus_shortname -->

<!-- disqus
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rmarkdown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
-->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
