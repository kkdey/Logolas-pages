<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Generating Consensus sequence from EDLogo</title>

<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>




<link rel="stylesheet" href="cosmo.css" type="text/css" />

</head>

<body>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:100,300,400,600" rel="stylesheet" type="text/css">
    <link href="../docs/cosmo.css" rel="stylesheet">
    <link href="../docs/cosmo.min.css" rel="stylesheet">
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="../docs/bootstrap/js/bootstrap.min.js"></script>

<body>

<div class = "nav" align = "middle">
<div class= "p1"></div>
<p>
  <a class="btn btn-large btn btn-primary" type="button" href = "Logolas_home.html">HOME</a>
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "Gallery.html">GALLERY</a>
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "https://github.com/kkdey/Logolas">SOFTWARE</a>
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "workflow.html">VIGNETTES</a>
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "license.html">LICENSE</a>
   &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "https://github.com/kkdey/Logolas-pages">GITHUB</a>
 </p>
</div>
<!-- <div class="nav">
  <a href="index.html">Home page</a> &nbsp &nbsp
  <a href="musings.html">Musings</a> &nbsp &nbsp
  <a href="town.html">My town</a> &nbsp &nbsp
  <a href="links.html">Links</a>
</div> -->

<!-- Main content -->
</body>
</html>


<h1 class="title toc-ignore">Generating Consensus sequence from EDLogo</h1>


<div id="TOC">
<ul>
<li><a href="#session-information">Session information</a></li>
</ul>
</div>

<!-- The file analysis/chunks.R contains chunks that define default settings
shared across the workflowr files. -->
<!-- Update knitr chunk options -->
<!-- Insert the date the file was last updated -->
<p><strong>Last updated:</strong> 2017-11-14</p>
<!-- Insert the code version (Git commit SHA1) if Git repository exists and R
 package git2r is installed -->
<p><strong>Code version:</strong> 90f571a</p>
<p>IUPAC has a specific nomenclature to call bases at each position of the sequence based on their relative probabilities of occurrence. See the nomenclature <a href="https://www.bioinformatics.org/sms/iupac.html">here</a>.</p>
<p>In the package <code>atSNP</code> by Sunduz Kelesâ€™ lab, a <code>GetIUPACSequence</code> function has been proposed to generate a consensus sequence based on IUPAC nomenclature from the position weight matrix.</p>
<pre class="r"><code>library(Logolas)
library(atSNP)

pwm=matrix(c(0.8,0.1,0.1,0,0.9,0.1,0,0,0.9,0.05,0.05,0,0.5,0.4,0,0.1,0.6,0.4,0,0,0.4,0.4,0.1,0.1,0.5,0,0.2,0.3,0.35,0.35,0.06,0.24,0.4,0.3,0.2,0.1,0.4,0.2,0.2,0.2,0.28,0.24,0.24,0.24,0.5,0.16,0.17,0.17,0.6,0.13,0.13,0.14,0.7,0.15,0.15,0),nrow = 4,byrow = F)
rownames(pwm)=c(&#39;A&#39;,&#39;C&#39;,&#39;G&#39;,&#39;T&#39;)
colnames(pwm)=1:ncol(pwm)

GetIUPACSequence(t(pwm))</code></pre>
<pre><code>[1] &quot;AAAMMMWMMAAAAA&quot;</code></pre>
<p>In <code>Logolas</code>, we can use the scoring scheme in an EDLogo plot to call the bases at each position and generate a new consensus sequence based on our own nomenclature that equally highlights enrichment and depletion.</p>
<pre class="r"><code>color_profile=list(&quot;type&quot; = &quot;per_row&quot;,&quot;col&quot; = RColorBrewer::brewer.pal(4,name =&quot;Spectral&quot;))
logomaker(pwm,color_profile = color_profile,frame_width = 1)</code></pre>
<p><img src="figure/nomenclature.Rmd/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>nlogomaker(pwm,logoheight = &#39;log&#39;,color_profile = color_profile,frame_width = 1)</code></pre>
<p><img src="figure/nomenclature.Rmd/unnamed-chunk-2-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>In this nomenclature, we use uppercase of the symbol to depict enrichment and lowercase of a symbol to depict depletion of that symbol.</p>
<pre class="r"><code>GetConsensusSeq(pwm)</code></pre>
<pre><code>[1] &quot;A A A (AC) (AC) (AC) c g N N N A A (At)&quot;</code></pre>
<p>As is clear from the EDLogo plot, the consensus sequence using this nomenclature is a more informative representation.</p>
<div id="session-information" class="section level2">
<h2>Session information</h2>
<!-- Insert the session information into the document -->
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.4.2 (2017-09-28)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS Sierra 10.12.5

Matrix products: default
BLAS: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
 [1] grid      stats4    parallel  stats     graphics  grDevices utils    
 [8] datasets  methods   base     

other attached packages:
 [1] atSNP_1.0            motifStack_1.22.0    Biostrings_2.45.3   
 [4] XVector_0.17.0       ade4_1.7-8           MotIV_1.34.0        
 [7] grImport_0.9-0       XML_3.98-1.9         GenomicRanges_1.30.0
[10] GenomeInfoDb_1.13.4  IRanges_2.12.0       S4Vectors_0.15.5    
[13] BiocGenerics_0.24.0  doParallel_1.0.11    iterators_1.0.8     
[16] foreach_1.4.3        data.table_1.10.4-3  Rcpp_0.12.13        
[19] Logolas_1.2.1       

loaded via a namespace (and not attached):
 [1] SummarizedExperiment_1.7.5 lattice_0.20-35           
 [3] colorspace_1.3-2           htmltools_0.3.6           
 [5] rtracklayer_1.37.3         yaml_2.1.14               
 [7] rlang_0.1.4                BiocParallel_1.11.4       
 [9] RColorBrewer_1.1-2         matrixStats_0.52.2        
[11] GenomeInfoDbData_0.99.1    plyr_1.8.4                
[13] stringr_1.2.0              zlibbioc_1.23.0           
[15] munsell_0.4.3              gtable_0.2.0              
[17] htmlwidgets_0.9            codetools_0.2-15          
[19] evaluate_0.10.1            Biobase_2.38.0            
[21] knitr_1.16                 scales_0.4.1              
[23] backports_1.1.0            rGADEM_2.26.0             
[25] BSgenome_1.46.0            seqLogo_1.44.0            
[27] DelayedArray_0.3.18        Rsamtools_1.29.0          
[29] ggplot2_2.2.1              digest_0.6.12             
[31] stringi_1.1.5              rprojroot_1.2             
[33] tools_3.4.2                bitops_1.0-6              
[35] magrittr_1.5               lazyeval_0.2.0            
[37] RCurl_1.95-4.8             tibble_1.3.4              
[39] Matrix_1.2-11              gridBase_0.4-7            
[41] SQUAREM_2017.10-1          rmarkdown_1.6             
[43] GenomicAlignments_1.13.4   git2r_0.19.0              
[45] compiler_3.4.2            </code></pre>
</div>

<hr>
<p>
    This webpage has been developed using RStudio's <a href="http://rmarkdown.rstudio.com">R Markdown</a> and John D Blischak's <a href="https://github.com/jdblischak/workflowr">workflowr</a> package. 
</p>
<hr>

<!-- To enable disqus, uncomment the section below and provide your disqus_shortname -->

<!-- disqus
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rmarkdown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
-->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
